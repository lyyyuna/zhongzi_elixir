package main

import (
	"fmt"
	"log"

	"github.com/lyyyuna/zhongzi_go/pkg/bencode"
)

// TorrentInfo represents a simplified torrent file structure
type TorrentInfo struct {
	Name        string `bencode:"name"`
	Length      int64  `bencode:"length"`
	PieceLength int64  `bencode:"piece length"`
	Pieces      []byte `bencode:"pieces"`
}

// TorrentFile represents a torrent file
type TorrentFile struct {
	Announce string      `bencode:"announce"`
	Info     TorrentInfo `bencode:"info"`
	Comment  string      `bencode:"comment,omitempty"`
}

func main() {
	fmt.Println("Go Bencode Protocol Example")
	fmt.Println("===========================")

	// Example 1: Basic data types
	basicExamples()

	// Example 2: Complex data structures
	complexExamples()

	// Example 3: Torrent file structure
	torrentExample()
}

func basicExamples() {
	fmt.Println("\n1. Basic Data Types:")

	// String encoding
	str := "Hello, Bencode!"
	encoded, err := bencode.Encode(str)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("String: %q -> %q\n", str, string(encoded))

	// Integer encoding
	num := int64(42)
	encoded, err = bencode.Encode(num)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("Integer: %d -> %q\n", num, string(encoded))

	// List encoding
	list := []interface{}{"spam", int64(42), "eggs"}
	encoded, err = bencode.Encode(list)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("List: %v -> %q\n", list, string(encoded))

	// Dictionary encoding
	dict := map[string]interface{}{
		"name": "John",
		"age":  int64(30),
		"city": "New York",
	}
	encoded, err = bencode.Encode(dict)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("Dict: %v -> %q\n", dict, string(encoded))
}

func complexExamples() {
	fmt.Println("\n2. Complex Data Structures:")

	// Nested structures
	nested := map[string]interface{}{
		"user": map[string]interface{}{
			"name":   "Alice",
			"id":     int64(123),
			"active": "true", // bencode doesn't have boolean, use string
		},
		"tags":  []string{"admin", "user"},
		"count": int64(5),
	}

	encoded, err := bencode.Encode(nested)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("Nested: %v\n", nested)
	fmt.Printf("Encoded: %q\n", string(encoded))

	// Decode it back
	decoded, err := bencode.DecodeBytes(encoded)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("Decoded: %v\n", decoded)
}

func torrentExample() {
	fmt.Println("\n3. Torrent File Structure Example:")

	// Create a sample torrent structure
	torrent := TorrentFile{
		Announce: "http://tracker.example.com:8080/announce",
		Info: TorrentInfo{
			Name:        "example.txt",
			Length:      1024,
			PieceLength: 256,
			Pieces:      []byte("abcdefghijklmnopqrstuvwxyz123456"), // 32 bytes (simplified)
		},
		Comment: "Example torrent file created with Go bencode",
	}

	// Encode the torrent structure
	encoded, err := bencode.Encode(torrent)
	if err != nil {
		log.Fatal(err)
	}

	fmt.Printf("Torrent structure encoded (%d bytes):\n", len(encoded))
	fmt.Printf("%q\n", string(encoded))

	// Decode it back
	var decodedTorrent TorrentFile
	err = bencode.Decode(encoded, &decodedTorrent)
	if err != nil {
		log.Fatal(err)
	}

	fmt.Printf("\nDecoded torrent:\n")
	fmt.Printf("Announce: %s\n", decodedTorrent.Announce)
	fmt.Printf("Name: %s\n", decodedTorrent.Info.Name)
	fmt.Printf("Length: %d bytes\n", decodedTorrent.Info.Length)
	fmt.Printf("Piece Length: %d bytes\n", decodedTorrent.Info.PieceLength)
	fmt.Printf("Pieces: %x (showing first 16 bytes)\n", decodedTorrent.Info.Pieces[:16])
	fmt.Printf("Comment: %s\n", decodedTorrent.Comment)

	// Demonstrate encoding individual parts
	fmt.Println("\n4. Individual Components:")

	// Just the info section
	infoEncoded, err := bencode.Encode(torrent.Info)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("Info section: %q\n", string(infoEncoded))

	// Working with raw data
	rawData := map[string]interface{}{
		"announce": "http://example.com/announce",
		"info": map[string]interface{}{
			"name":         "test.txt",
			"length":       int64(512),
			"piece length": int64(128),
		},
	}

	rawEncoded, err := bencode.Encode(rawData)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("Raw data: %q\n", string(rawEncoded))

	// Decode raw data back
	rawDecoded, err := bencode.DecodeBytes(rawEncoded)
	if err != nil {
		log.Fatal(err)
	}
	fmt.Printf("Raw decoded: %v\n", rawDecoded)
}